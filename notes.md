These are my notes for the class.

# Using Git and GitHub
Git allows you to track versions of files in a directory, and it allows you to clone all of those versions to a different location (usually a different computer).

### using git
You can track file versions of any files by initialising Git for that repository.

```
-> mkdir playingwithGit
-> cd playingwithGit
-> git init
```
If you list all the files in the directory you'll see a hidden directory named .git

```
-> ls -la
total 0
drwxr-xr-x   3 lee  staff    96 Dec  1 22:59 .
drwxr-xr-x+ 54 lee  staff  1728 Dec  1 23:00 ..
drwxr-xr-x   9 lee  staff   288 Dec  1 22:59 .git
```

.git is where all of the versions get stored. You can use the echo command to create a file so we can see how versionally works. use git status to tel you what git is doing

```
-> echo hello world > hello.txt
-> git status

On branch master
No commits yet
Untracked files:
  (use "git add <file>..." to include in what will be committed)
 hello.txt

nothing added to commit but untracked files present (use "git add" to track)
```

git status tells you that it detects a new file names hello.txt but it isn't tracking versions for the file. You need to add it in order to track versions of the file. Usually, you track all files in a repository directory so you can tell git to track everything that it doesn't know about with `git add .`  Make sure you include the period! follow this with another git status to see what the repo looks like.

```
-> git add .
-> git status

On branch master
No commits yet
Changes to be committed:
  (use "git rm --cached <file>..." to unstage)
 new file:   hello.txt
```

now git says that is has STAGED the file, meaning it is ready to be committed as a version in the repo. we commit the version with a `commit` command. Always add a comment about the version you are committing, use `-m` to provide a version.

```
-> git commit -m "initial draft"
[master (root-commit) d43b07b] initial draft
 1 file changed, 1 insertion(+)
 create mode 100644 hello.txt

-> git status
On branch master
nothing to commit, working tree clean
```

In this example, only one file was committed, but you can reperesent multiple files in a commit. You just have to add them all before committing. Only files that have been staged will be committed.

By adding a `-a` parameter with our message, we can tell git to add all the modified tracked files to our commit without using git add

```
-> echo goodbye world > hello.txt

-> git commit -am "changed greeting to reflect the present mood"

[master e65f983] changed greeting to reflect the present mood
 1 file changed, 1 insertion(+), 1 deletion(-)
```
with a couple of versions in the repo, you can see the versions with `git log`

```
-> git log

commit e65f9833ca8ee366d0d9c1676a91b1a977dab441 (HEAD -> master)
Author: Lee
Date:   Thu Dec 1 23:32:22 2022 -0700

    changed greeting to reflect the present mood

commit d43b07b8890f52defb31507211ba78785bf6dccf
Author: Lee
Date:   Thu Dec 1 23:29:11 2022 -0700

    initial draft
```

## SHA
Every commit has an identifier generated by hashing the file along with the timestamp using the SHA hashing alogirthm. If you use the SHA, you can find a specific commit in your version history. For example: we want to temporarily switch back to a previous version to see what is in it.

```
-> git checkout d43b07b8890f

Note: switching to 'd43b07b8890f'.
HEAD is now at d43b07b initial draft

-> cat hello.txt
hello world
```
the output omits a message saying that you are no longer looking at the latest version. Don't make commits now or it will create a branch that doesn't have the latest code. Use the `checkout` command and referece the branch name (default is master) to return to the top version.

```
-> git checkout master
Previous HEAD position was d43b07b initial draft
Switched to branch 'master'

-> cat hello.txt
goodbye world
```
## Diff
Most often you don't want to revert to an earlier commit, but just see what has changed between them. Do that with the `diff` command by specifying two SHAs you want to copare, or use the `HEAD` variable (always points to the commit you're currently looking at). To refer to an earlier commit you add ~ and the numerical distance from HEAD. In this example its head and head~1

```
-> git diff HEAD HEAD~1
```

```
diff --git a/hello.txt b/hello.txt
index 3b18e51..eeee2af 100644
--- a/hello.txt
+++ b/hello.txt
@@ -1 +1 @@
-hello world
+goodbye world
```
## Branches
Branches allow you to work on variations of the code while still allowed progress on the main branch. Ex: you want to work on a new feature A wihout interrupting the master branch, you would use `git branch A` command to create a branch named A, them start working on the new branch with the `git checkout A` command. You can now make commits on both branches. When you want to combine them, checkout the master branch and use `git merge A`. if you decided you don't like A, just don't merge it.

## Git commands
to start working on an area
- clone -> clones a repository to a new directory
- init -> create an empty repository using git

work on the current change
- add -> add file contents to the index
- mv -> move or rename a file, directory, or a symlink
- restore -> restore working tree files
- rm -> remove fules from the working tree and from the index

examine history and state
- bisect -> use binary search to find the commit that introduced a bug
- diff -> show changes between commits, commit and working tree, etc
- grep -> print lines matching a pattern
- log -> show commit logs
- show -> show various types of objects
- status -> show the working tree status

grow, mark, and tweak your common history
- branch -> list, create, or delete branches
- commit -> record changes to the repository
- merge -> join two or more development histories together
- rebase -> reapply commits on top of another base tip
- reset -> reset current HEAD to the specified state
- switch -> switch branches
- tag -> create, list, delete, or verify a tag obkect signed with GPG

collaborate
- fetch -> download obkects and refs from another repository
- pull -> fetch from and integrate with another repository or a local branch
- push -> update remote refs along with associated objects

# startup application
The different elements of our startup.
- html -> basic structural and organisational elements
- css -> style and animation
- javascript -> interaction
- service -> remote functions that your application calls on your, or someone els's web server
- database/login -> persisted app and auth data
- websocket -> data pushed from server, chat, realtime data from the server
- react -> web framework

# history of the web
There are three distinct phases in the history of the web.
1) The formation of the internet that supports the communication of web applications
2) the creation of HTML and HTTP that made it possible to share hyperlinked documents (web 1.0)
3) the creation of CSS and JavaScript that enabled interactive web applications (web 2.0)

## the internet
The first step was formation of global communications network that was reliable and publicly available. The US department of defense created ARPANET as a means of sharing info between universities doing related research. ARPANET was created with the goal of withstanding a nuclear attack. The network of connecting computers was set up so two computers communicate by dynamically discovering a path to each other without the help of a central authority.

Functionality was expanded in the 80s by the national science foundation, and commerical enterprises. There was a boom of consumer participation in the early 90s, and another large increase in the 200s as smart phones and appliances were wide spread.

The internet engineering task force (IETF) and the internet corporation for assigned names and numbers (ICANN) manage the internet. IETF defines the technical standards that specify how the physical network communicates. ICANN oversees both the internet protocol (IP) address space, and the domain name system (DNS). These databases make up an address book of the internet. The US transfered control of both of these to a global community of non-profit stake holders in 2016, making the internet a worldwide asset free from any political control.

## Hypertext markup language (HTML)
HTML was created by Tim Berners-Lee. In 1980 he was working at the research lab Cern. His job was to build a system that would let researchers share documents between remote academic institutions. ARPANET already provided the necessary connectivity, so he defined the protocols for document sharing that formed the underpinning of what would be termed the world wide web. He named the format HTML based on inspiration from the digital publishing industry's standard generalised markup language (SGML). One key idea of HTML was hyperlinks, letting documents be interconnected. Hyperlinks allow immediate access to related documents. In the 90s he put it all together and built the worlds first web server.

At first, HTML only had 18 elements. The latest version has over 100. This boom was caused partly by browser vendors wanting to have different functionality for market value. Since 1996, HTML specification has been controlled by W3C.

### HTTP and URL
Berners-Lee also defined the hypertext transfer protocol (HTTP) and the uniform resource location (URL). These specify how web documents are addressed and transmitted across the internet.

## Cascading Style Sheets (CSS)
First proposed in 1994 by H√•kon Wium Lie. He worked with Berners-Lee at Cern, and the goal was to give HTML documents visual styling that was separate from the structure. Before CSS, you had to style HTML with hard coding what you wanted into the elements. 

By 1996, CSS was a standard and was being implemented on all major browsers. The same problems that HTML had were passed to CSS for the first few years.

With modern CSS, you can import fonts, animate HTML elements, respond to user actions, and dynamically alter the entire page based on device and orientation.

## JavaScript
Netscape wanted to add the ability to script web pages in 1995. Initial version was created by Brandon Eich. JS made the web an interactive experience, and made it the pages would change dynamically based on the users. Control of JS was given to ECMA in 1996 in order to standardise it. It's technically called ECMAScript now.

The first decade was difficult because all major browsers wanted to make new features. In 2009, major vendors agreed on ECMAScript 5 standard. In 2015, the last major feature upgrade was released.

### JS outside the browser
In 2009, Ryan Dahl created Node.js. This was the first application for deploying JS outside of the browser, making it widespread across the technology stack instead of just being used for web design. Another important milestone was JSON in 2013, TypeScript in 2012, and numerous transpilers to convert other languages into compatible ECMAScript.

# Technology Stack
This is the collection of technologies you use to create/deliver your web application. It's called a stack because the technologies layer atop one another. Generally the web framework is at the top (Angular, React, Vue, Svelte, etc). The framework talks to web services for authentication, business, data, storage. Web service then talked to backend services for things like caching, database, logging, monitering.

- React, Caddy2, nodejs, mongoDB

heres how you access the server from the console

ssh -i [key pair file] ubuntu@[ip address]

# Caddy, HTTPS, TLS, certs
Caddy
- runs on the webserver
- handles routing requests
- web certificates for HTTPS

web certificate
- client wants secure access
- goes to your server
- goes to a third party to encrypt
- gets decrypted to verify
- trusted third party - both sides trust
- need the public key to verify

use sudo service caddy restart to save the files and restart it so you can see the changes, or the change won't save

# Console and Editors
terminal allows you to
- navigate your disk
- run console applications (ones without graphical user interface/GUI)

common console commands
- echo -> output the parameters of the command
- cd -> change directory
- mkdir -> make directory
- rmdir -> remove directory
- rm -> remove file(s)
- mv -> move file(s)
- cp -> copy files
- ls -> list files
- curl -> command line client URL browser
- grep -> regular expression search
- find -> find files
- top -> view running processess
- df -> view disk statistics
- cat -> output file
- less -> interactive file output
- wc -> count words
- ps -> view processess
- kill -> kill a process
- sudo -> execute as admin
- ssh -> remote shell
- scp -> securely copy files to a remote computer
- history -> show history of commands
- ping -> test connection
- tracert -> trace network
- dig -> DNS information
- man -> look in the manual

pipe & redirect
- printf "hello world" > test.txt
- ls -l | grep ' Nov ' | wc -l
- curl -s www.google.com > google.html
- cat google.html | grep '<a' | wc
- curl -s www.google.com | wc

control keys
- CTRL-C -> cancel command
- CTRL-R -> recall command
- CTRL-Z -> background command

visual studio code extensions
- live server
- GitLens

# HTML - Hypertext Markup Language

link references
- absolute
  - ```<a href="https://cs260.click/profile.png" />```
- relative
  - ```<a href="profile.png" />```
  - ```<a href="../images/profile.png" />```
 
elements
|element|meaning|
|---|---|
|html|the page container|
|head|header information|
|title|title of the page|
|meta|metadata for the page such as character set or viewport settings|
|script|JavaScript reference. Either external reference, or inline|
|include|external content reference|
|body|the entire content of the page|
|header|header content|
|footer|footer of the main content|
|nav|navigational inputs|
|main|main content of the page|
|section|a section of main content|
|aside|aside content from the main content|
|div|a block division of content|
|span|an inline span of content|
|h<1-9>|text heading. from h1, the highest level, down to h9, the lowest|
|p|a paragraph of text|
|b|bring attention|
|table|table|
|tr|table row|
|th|table header|
|td|table data|
|ol, ul|ordered or unordered list|
|li|list item|
|a|anchor the text to a hyperlink|
|img|graphical image reference|
|dialog|interactive component such as a confirmation|
|form|a collection of user input|
|input|user input field|
|audio|audio content|
|video|video content|
|svg|scalable vector graphic content|
|iframe|inline frame of another HTML page|

p and div work in similar ways, but you can have more information in a p tag. That way you can separate text. Simply by looking, it doesn't know what div means, but the p tag tells the tools what to do.

you can include comments by starting text with ```<!--- commented text -->``` -> the text in the comments will be ignored while being rendered

special characters
|character|entity|
|---|---|
|`&`|```&amp;```|
|<|```&lt;```|
|>|```&gt;```|
|"|```&quot;```|
|'|```&apos;```|
|üòÄ|```&#128512;```|

by default, the browser will display the index.html page if you don't provide a specific file. It is common to name the main HTML file index.html

|element|meaning|example|
|---|---|---|
|`form`|input container and submission|`<form action="form.html" method="post>`|
|`fieldset`|labeled input grouping|`<fieldset>...</fieldset>`|
|`input`|multiple types of user input|`<input type="" />`|
|`select`|selection dropdown|`<select><option>1</option></select>`|
|`optgroup`|grouped selection dropdown|`<optgroup><option>1</option></optgroup>`|
|`option`|selection option|`<option selected>option2</option>`|
|`textarea`|multiline text input|`<textarea></textarea>`|
|`label`|individual input label|`<label for="range">Range: </label>`|
|`output`|output of input|`<output for="range">0</output>`|
|`meter`|display valye with a known range|`<meter min="0" max="100" value="50"></meter>`|

input elements
|type|meaning|
|---|---|
|text|single line textual value|
|password|obscured password|
|email|email address|
|tel|telephone number|
|url|URL address|
|number|numerical value|
|checkbox|inclusive selection|
|radio|exclusive selection|
|range|range limited number|
|date|year, month, day|
|datetime-local|date and time|
|month|year, month|
|week|week of year|
|color|colour|
|file|local file|
|submit|button to trigger form submission|

to create input you have to specificy the type attribute and any others needed for that specific input.

ex: checked radio button 

`<label for="checkbox1">Check me</label> <input type="checkbox" name="varCheckbox" value="checkbox1 checked />`

most common attributes
|attribute|meaning|
|---|---|
|name|the name of the input. this is submitted as the name of the input if used in a form|
|disabled|disables the ability for the user to interact with the input|
|value|the initial value of the input|
|required|signifies that a valye is required in order to be valid|

# CSS

## Selectors

|selector|meaning|example|description|
|---|---|---|---|
|element|all elements of a specific name|`p` `div`|any selection that is a descendent of a body|
|ID|the element with the given ID|`#root`|the element with the attribute `id='root'`|
|class|all elements with the given class|`.highlight`|any element with the attribute `class='highlight'`|
|element class|any elements with the specific name and class|`p.highlight`|any p element with the attribute `class='highlight'`|
|list|any of the given selectors|`body, section`|body or section elements|
|descendant|a list of descendants|`body section`|any section that is a descendant of a body|
|child|a list of direct children|`section>p`|any p that is a direct child of a section|
|psuedo|state based|`p:hover`|the mouse is hovering over a p element|

## Declarations

|property|value|example|discussion|
|---|---|---|---|
|background|colour|`red`|fill the background colour|
|border|colour width style|`#fad solid medium`|sets the border using shorthand where any or all of the values may be provided|
|colour|colour|`rgb(128, 0, 0)`|sets the text colour|
|display|type|`none`|defines how to display the element and its children|
|font|family size style|`Arial 1.2em bold`|defines the text font using shorthand|
|margin|unit|`5px 5px 0 0`|sets the margin spacing|
padding|unit|`1em 2em`|sets the padding spacing|

units
|unit|description|
|---|---|
|px|the number of pixels|
|pt|the number of points (1/72 of an inch)|
|%|a percentage of the parent element|
|em|a multiplier of the width of the letter `m` in the parents font|
|rem|a multiplier of the width of the letter `m` in the roots font|
|vw|a percentage of the viewports width|
|vh|a percentage of the viewports height|
|vmin|a percentage of the viewports smaller dimension|
|vmax|a percentage of the viewports larger dimension|

## Fonts
- san serif -> only major strokes
- serif -> minor strokes off the major strokes
- monospace -> all letters have the same size
- handwriting -> cursive strokes
use google fonts to browse open source fonts

```@font-face {
font family: 'Quicksand';
src: url('https://cs260.click/fonts/quicksand.ttf');
}

p {
 font-family: Quicksand;
}

```
```
@import url("https://fonts.googleapis.com/css2?family=Rubik Microbe&display=swap");

p {
 font-family: "Rubik Microbe";
}
```
using import is just referencing the link and using css

## Unicode and UTF-8
```
<!DOCTYPE html>
<html lang="en">
 <head>
   <meta charset="UTF-8" />
 </head>
 <body>
   <p>ÌïòÎÇòÎãòÏùÄ ÎÇòÏùò ÎπõÏù¥ÏãúÎã§</p>
   <p>üòÉ &#128521;</p>
 </body>
</html>
```
## CSS Animation
CSS animation uses `animation` properties and defining `keyframes` for what the element needs to look like at different times of the animation. 

For example. We have a paragraph and want it to zoom in until its 20% of the view height.
```css
p {
  text-align: center;
  font-size: 20vh;
}
```
We need to specify that we are animating this element by adding `animation-name` property with value of demo. This refers to the name of the `keyframes`. The keyframes tell what properties should be applied at different key points. You also add `animation-duration` to specify the lenght.
```css
p {
  text-align: center;
  font-size: 20vh;

  animation-name: demo;
  animation-duration: 3s;
}
```
You don't need to define the keyframes for every second of the animation. Instead, just do the key points and CSS will do the rest. For this example, we want it to start invisible and have it zoom into the full final size. We do this with `from` and `to`.
```css
@keyframes demo {
  from {
    font-size: 0vh;
  }

  to {
    font-size: 20vh;
  }
}
```
The last addition here is to make the paragraph bounce out a little bigger than the final size by adding another keyframe that happens at 95% through.
```css
@keyframes demo {
  from {
    font-size: 0vh;
  }

  95% {
    font-size: 21vh;
  }

  to {
    font-size: 20vh;
  }
}
```

## CSS Responsive Design
Responsive design is the web applications ability to reconfigure the interface based on screen size and orientation. Alot of HTML and CSS is already fluid to respond to a browser being resized.

### Display
Allows you to change how HTML elements are being displayed. Here are some common options

|value|meaning|
|---|---|
|none|dont display this element. the element still exists, but the browser will not render it|
|block|display this element with a width that fills its parent element. a `p` or `div` element has block display by default|
|inline|display this element with a width that is only as big as its content. a `b` or `span` element has inline display by default|
|flex|display this elements children in a flexible orientation|
|grid|display this elements children in a grid orientation|

```html
<div class="none">None</div>
<div class="block">Block</div>
<div class="inline">Inline1</div>
<div class="inline">Inline2</div>
<div class="flex">
  <div>FlexA</div>
  <div>FlexB</div>
  <div>FlexC</div>
  <div>FlexD</div>
</div>
<div class="grid">
  <div>GridA</div>
  <div>GridB</div>
  <div>GridC</div>
  <div>GridD</div>
</div>
```
This HTML renders like this by default:
![image](https://github.com/aswens1/startup/assets/156115207/ce0cad37-abed-41ff-99ac-d5a0867622b6)

Modifying it with CSS we can render it differently.
```css
.none {
  display: none;
}

.block {
  display: block;
}

.inline {
  display: inline;
}

.flex {
  display: flex;
  flex-direction: row;
}

.grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
}
```
![image](https://github.com/aswens1/startup/assets/156115207/79e03b08-4cfa-43d3-927f-b1866ea8c5a1)

### Viewport Meta Tag
include this in the head of all HTML pages to tell the browser not to scale the page

```html
<meta name="viewport" content="width=device-width,initial-scale=1" />
```

### float
Float moves an element to the left or the right of its container and allows inline elements to wrap around it.
```css
aside {
  float: right;
  padding: 3em;
  margin: 0.5em;
  border: black solid thin;
}
```

### media queries
one of the main features for responsive applications is `@media` selector, which dynamically detects the size and orientation of the device and applies CSS rules to represent the HTML in a way that accomodates the change. We can use this to tell which side of the screen is the longest. Media queries take one or more predicates separated by boolean operators. 
In this example, we want to know if the screen is in portrait mode of not. If it is, it transforms all the div elements by rotating them 270 degrees.
```css
@media (orientation: portrait) {
  div {
    transform: rotate(270deg);
  }
}
```
you can also use these to make entire sections disappear. In this example, we want to hide an aside when the screen is narrow.
```css
@media (orientation: portrait) {
  aside {
    display: none;
  }
}
```

## CSS grid
this is useful when you want to display a group of child elements in a responsive grid. start with a container with a bunch of child elements
```html
<div class="container">
  <div class="card"></div>
  <div class="card"></div>
  <div class="card"></div>
  <div class="card"></div>
  <div class="card"></div>
  <div class="card"></div>
  <div class="card"></div>
  <div class="card"></div>
  <div class="card"></div>
</div>
```
we turn this response with the display property with the value of grid on the container. `grid-template-columns` specifies the layout of the grid columns.
```css
.container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  grid-auto-rows: 300px;
  grid-gap: 1em;
}
```

## CSS flexbox
This is useful when you want to partition your application into areas that responsively move around as the window resizes or the orientation changes. 

# JavaScript

## Introduction
```'Hello' + 'world';```

console.log('Hello' + ' ' + 'world'); -> // OUTPUT: Hello world

create your own functions:
function join(a, b) {
    return a + ' ' + b;
}

console.log(join('Hello', 'world')); -> // OUTPUT: Hello world

comments:

// line comments

/*
block comment
*/

code delimiters:
- end JS statements with a semicolon (;)
- code blocks, and resulting scope, are defined with curly brackets ({})

## JavaScript Console
The console lets us interact with the JS runtime debugger console. Provides functionality for outputting the value of text and objects, running timers, and counting iterations. These are useful for degbugging.
This is not the same thing as the computers command line/terminal.

### Log
Basic usage of the console is to output a log message

console.log('hello'); -> // OUTPUT: Helo 

formatted messages:

console.log('hello %s', 'world'); -> //OUTPUT: hello world

specify CSS declarations to style the log output

console.log('%c JavaScript Demo', 'font-size:1.5em; color:green;'); -> // OUTPUT: JavaScript Demo //in large green text

### Timers
You can see how long a piece of code is running

console.time('demo time');

// ... some code that takes a long time

console.timeEnd('demo time');

// OUTPUT: demo time: 9762.74 ms

### count
Tells how many times a block of code is called

console.count('a'); -> // OUTPUT: a: 1

console.count('a'); -> // OUTPUT a: 2

console.count('b'); -> // OUTPUT b: 1

## Adding JavaScript to HTML
You can add JS to HTML by either directly including it in the HTML within the content of a \<script> element, or by using the src attribute of the script element and referencing an external JS file

if we have a file index.js
```javascript
function sayHello() {
  console.log('hello');
}
```

heres how we call it in our html index.html
```html
<head>
  <script src="javascript.js"></script>
</head>
<body>
  <button onclick="sayHello()">Say Hello</button>
  <button onclick="sayGoodbye()">Say Goodbye</button>
  <script>
    function sayGoodbye() {
      alert('Goodbye');
    }
  </script>
</body>
```

We call the sayHello and sayGoodbye JS functions in HTML in the onclick attribute of the buttom element. Some special attributes automatically create event listeners for different DOM events that call the code contained in the attribute's value. The code in the attribute can be a simple function call or any JavaScript code.

```html
<button onclick="let i=1;i++;console.log(i)">press me</button>
<!-- OUTPUT: 2 -->
```
## JavaScript type and construct

### Declaring Variables
Variables are declared using either let or const keyword. let allows you to change the value of the varibale while const will always stay the same (you'll get an error if you try to change it)

```javascript
let x = 1;
const y = 2;
```

### Type
There are several primative types

|type|meaning|
|---|---|
|`Null`|the type of a variable that has not been assigned a value|
|`Undefined`|the type of a variable that has not been defined|
|`Boolean`|true or false|
|`Number`|a 64-bit signed number|
|`BigInt`|a number of arbitrary magnitude|
|`String`|a textual sequence of characters|
|`Symbol`|a unique value|

Boolean, Number, and String are the most commonly used when creating variables. But variables also often refer to the Null or Undefined primitive. JavaScript does not enforce the declaration of a variable before you use it, so it could have the type Undefined.

There are also defined objects types.

|type|use|example|
|---|---|---|
|`Object`|a collection of properties represented by name-value pairs. values can be any type| `{a:3, b:'fish'`|
|`Function`|an object that has the ability to be called|`function a() {}`|
|`Date`|calendar dates and times|`new Date('1995-12-17')`|
|`Array`|an ordered sequence of any type|`[3, 'fish']`|
|`Map`|a collection of key-value pairs that support efficient lookups|`new Map()`|
|`JSON`|a lightweight data-interchange format used to share information across programs|`{"a":3, "b":"fish"}`|

### Common Operators
When dealing with numbers, there are standard mathematical operators.
- `+` -> add
- `-` -> subtract
- `*` -> multiply
- `/` -> divide
- `===` -> equality

For strings:
- `+` -> concatenation
- `===` -> equality

### Type Conversions
JS is a weakly typed function, which means a variable always has a type but it can be changed when the value changes, or the type can be converted based on context. Sometimes the conversions are unexpected if you're used to strongly typed languages.

```javascript
2 + '3';
// OUTPUT: '23'
2 * '3';
// OUTPUT: 6
[2] + [3];
// OUTPUT: '23'
true + null;
// OUTPUT: 1
true + undefined;
// OUTPUT: NaN
```

Getting unexpected results is really common with the equality operator.

```javascript
1 == '1';
// OUTPUT: true
null == undefined;
// OUTPUT: true
'' == false;
// OUTPUT: true
```

JavaScript uses complex rules for defining equality that depends upon the conversion of a type of boolean value. This is sometimes called falsy and truthy evaluations. To fix this, there is strict equality and equality. The strict operators skip the type conversion when computing equality.

- `===` -> strict equality
- `!==` -> inequality

```javascript
1 === '1';
// OUTPUT: false
null === undefined;
// OUTPUT: false
'' === false;
// OUTPUT: false
```

Strict equality is considered more intuitive, and is preferred. 

```javascript
('b' + 'a' + +'a' + 'a').toLowerCase();
```

### Conditionals
Javascript supports many common programming language conditional constructs, including if, else, and if else.

```javascript
if (a === 1) {
  //...
} else if (b === 2) {
  //...
} else {
  //...
}
```

There is also the ternary operator, which provides a compact if else representation.

```javascript
a === 1 ? console.log(1) : console.log('not 1');
```

You can use boolean operations in the expression to create complex predicates. Common operators are:

- `&&` -> and
- `||` -> or
- `!` -> not

```javascript
if (true && (!false || true)) {
  //...
}
```

### Loops
JavaScript supports many common looping constructs. This includes, for, for in, for of, while, do while, switch. Here are examples.

#### For Loop
Introduces common post increment operation `i++` for adding one to a number.

```javascript
for (let i = 0; i < 2; i++) {
  console.log(i);
}
// OUTPUT: 0 1
```

#### Do While

```javascriptlet
i = 0;
do {
  console.log(i);
  i++;
} while (i < 2);
// OUTPUT: 0 1
```

#### While

```javascript
let i = 0;
while (i < 2) {
  console.log(i);
  i++;
}
// OUTPUT: 0 1
```

#### For in
Iterates over an objects property names.

```javascript
const obj = { a: 1, b: 'fish' };
for (const name in obj) {
  console.log(name);
}
// OUTPUT: a
// OUTPUT: b
```

For arrays the objects name is the array index

```javascript
const arr = ['a', 'b'];
for (const name in arr) {
  console.log(name);
}
// OUTPUT: 0
// OUTPUT: 1
```

#### For of
Iterates over an iterables (array, map, set, etc) property values

```javascript
const arr = ['a', 'b'];
for (const val of arr) {
  console.log(val);
}
// OUTPUT: 'a'
// OUTPUT: 'b'
```

#### Break and continue
All of the examples either use a break or continue statement to abort or advance a loop

```javascript
let i = 0;
while (true) {
  console.log(i);
  if (i === 0) {
    i++;
    continue;
  } else {
    break;
  }
}
// OUTPUT: 0 1
```

## Strings
``` javascript
'quoted text'; // " also works

const l = 'literal';
console.log(`string ${l + (1 + 1)} text`);
// OUTPUT: string literal2 text
```
- primative types
- can use single quotes, double quotes, or backticks `

### Unicode Support
Defines a string as a 16-bit unsigned integer that represents UTF-16 strings.
Lets JavaScript display most languages on the planet. This includes those that are read right to left.

### String functions
The string object has several interesting functions associated with it. Here are the common ones

|Function|meaning|
|---|---|
|length|the number of characters in the string|
|indexOf()|the starting index of a given substring|
|split()|split the string into an array on the given delimiter string|
|startsWith()|true if the string has a given prefix|
|endsWith()|true if the string has a given suffix|
|toLowerCase()|converts all characters to lower case|

```javascript
const s = 'Example:Ï°∞ÏÑ†Í∏Ä';

console.log(s.length);
// OUTPUT: 11
console.log(s.indexOf('Ï°∞ÏÑ†Í∏Ä'));
// OUTPUT: 8
console.log(s.split(':'));
// OUTPUT: ['Example', 'Ï°∞ÏÑ†Í∏Ä']
console.log(s.startsWith('Ex'));
// OUTPUT: true
console.log(s.endsWith('Ï°∞ÏÑ†Í∏Ä'));
// OUTPUT: true
console.log(s.toLowerCase());
// OUTPUT: example:Ï°∞ÏÑ†Í∏Ä
```

## Functions
Functions are first class objects. They can be assigned a name, passed as a parameter, returned as a result, and referenced from an object or array like any other variable.

Syntax begins with the function keyword followed by zero or more parameters and a body that may contain zero or more return statements. The return statment may return a single value. There are no type declarations, as the type is always inferred by the assignment of the value to the parameter.

```javascript
function hello(who) {
  return 'hello ' + who;
}

console.log(hello('world'));
// OUTPUT: hello world
```

If the function doesn't return a value, it usually is there to produce a side effect like modifying a parameter or interacting with an external program. In the next example the side effect is to output text to the debugger.

```javascript
function hello(who) {
  who.count++;
  console.log('hello ' + who.name);
}

hello({ name: 'world', count: 0 });
// OUTPUT: hello world
```

### Function Parameters
The one who calls the function decides what parameters to provide. If there are no parameters, the value is undefined when the function executes.

The function can also define a default value. This is done by assigning a value to the parameter in the function declaration.

```javascript
function labeler(value, title = 'title') {
  console.log(`${title}=${value}`);
}

labeler();
// OUTPUT: title=undefined

labeler('fish');
// OUTPUT: title=fish

labeler('fish', 'animal');
// OUTPUT: animal=fish
```

### Anonymous Functions
Functions are commonly assigned a variable so that they can be passed as a parameter in other functions or stored as an object property. You can do this easily by define a function anonymously and assign it to a variable.

```javascript
// Function that takes a function as a parameter
function doMath(operation, a, b) {
  return operation(a, b);
}

// Anonymous function assigned to a variable
const add = function (a, b) {
  return a + b;
};

console.log(doMath(add, 5, 3));
// OUTPUT: 8

// Anonymous function assigned to a parameter
console.log(
  doMath(
    function (a, b) {
      return a - b;
    },
    5,
    3
  )
);
// OUTPUT: 2
```

### Creating, Passing, and Returning Functions
Example of assigning functions to variables, as well as using a function as parameters and return values.

```javascript
// Anonymous declaration of the function that is later assigned to a variable
const add = function (a, b) {
  return a + b;
};

// Function that logs as a side effect of its execution
function labeler(label, value) {
  console.log(label + '=' + value);
}

// Function that takes a function as a parameter and then executes the function as a side effect
function addAndLabel(labeler, label, adder, a, b) {
  labeler(label, adder(a, b));
}

// Passing a function to a function
addAndLabel(labeler, 'a+b', add, 1, 3);
// OUTPUT: a+b=4

// Function that returns a function
function labelMaker(label) {
  return function (value) {
    console.log(label + '=' + value);
  };
}

// Assign a function from the return value of the function
const nameLabeler = labelMaker('name');

// Calling the returned function
nameLabeler('value');
// OUTPUT: name=value
```

### Inner Functions
Functions can also be declared inside other functions. This way you can modularise your code without always exposing private details.

```javascript
function labeler(value) {
  function stringLabeler(value) {
    console.log('string=' + value);
  }
  function numberLabeler(value) {
    console.log('number=' + value);
  }

  if (typeof value == 'string') {
    stringLabeler(value);
  } else if (typeof value == 'number') {
    numberLabeler(value);
  }
}

labeler(5);
// OUTPUT: number=5

labeler('fish');
// OUTPUT: string=fish
```

## JavaScript Arrow Function
These are used to clean up code and make it more compact. This replaces the need for the function keyword with the symbols `=>` places after the parameter declaration. The curly braces around it are optional.

This function takes no parameters and always returns 3.
```javascript
() => 3;
```

The following two are equivalent.

```javascript
const a = [1, 2, 3, 4];

// standard function syntax
a.sort(function (v1, v2) {
  return v1 - v2;
});

// arrow function syntax
a.sort((v1, v2) => v1 - v2);
```

Arrow functions cannot be used for constructors or iterator generators.

### Return Values
There are special rules for the return keyword. This is optional if no curly braces are provided for the function and it contains a single expression. In that case the result of the function is automatically returned. If curly braces are provided, then the arrow function behaves just like a standard function.

```javascript
() => 3;
// RETURNS: 3

() => {
  3;
};
// RETURNS: undefined

() => {
  return 3;
};
// RETURNS: 3
```

### This pointer
Arrow functions inherit the this pointer from the scope of where it is created. This makes it a closure. A closure allows a function to continue referencing its creation scope, even after it has passed out of that scope. 

In this example, the function returns an anonymous function using the arrow syntax. The `a` parameter is overridden, a new `b` variable is created, and both `a` and `b` are referenced in the arrow function. They are both part of the closure for the returned function.

```javascript
function makeClosure(a) {
  a = 'a2';
  const b = 'b2';
  return () => [a, b];
}
```

Then we can declare the variables `a` and `b` at the top level scope, and call  `makeClosure` with `a`.

```javascript
const a = 'a';
const b = 'b';

const closure = makeClosure(a);
```

Then when we call closure it will output the values contained in scope where it was created instead of the current values of the variables.

```javascript
console.log(closure());
// OUTPUT: ['a2', 'b2']

console.log(a, b);
// OUTPUT: 'a' 'b'
```

Closures provide a valuable property when we do things like execute JavaScript within the scope of an HTML page, because it can remember the values of variables when the function was created instead of what they are when they are executed.

### Putting it all together

Test all together by using a debounce function.
The point of a debounce function is to only execute a specified function once within a given time window. Any requests to execute the debounce function more frequently than this will make the window reset. This is important in cases where a user can trigger expensive events thousands of times per second. Without a debounce the performance can suffer.

This example uses the browsers `window.addEventListener` function to add a callback function that is invoked whenever the user scrolls the browsers web pages. The first parameter specified that it wants to listen for scroll events. The second parameter provides the function to call when a scroll event happends. In this example its debounce.

The debounce takes two parameters, the time window for executing the window function, and the window function to call within that limit. 

```javascript
window.addEventListener(
  'scroll',
  debounce(500, () => {
    console.log('Executed an expensive calculation');
  })
);
```

The debounce function implements the execution of windowFunc within the restricted time window by creating a closure that contains the current timeout and returning a function that will reset the timeout every time it is called. The returned function is what the scroll event will actually call when the user scrolls the page. However, instead of directly calling the windowFunc it sets a timer based on the value of windowMs. If the debounce function is called again before the window times out then it resets the timeout.

```javascript
function debounce(windowMs, windowFunc) {
  let timeout;
  return function () {
    console.log('scroll event');
    clearTimeout(timeout);
    timeout = setTimeout(() => windowFunc(), windowMs);
  };
}
```

## JavaScript Array
An array object represents a sequence of other objects and primatives. You can reference the members of the array using a zero based index. You can create an array with the array constructor or using the array literal notation shown below.

```javascript
const a = [1, 2, 3];
console.log(a[1]);
// OUTPUT: 2

console.log(a.length);
// OUTPUT: 3
```

### Object Functions
The array has several interesting static functions associated with it.

|Function|Meaning|Example|
|---|---|---|
|push|add an item to the end of an array|`a.push(4)`|
|pop|remove an item from the end of the array|`x = a.pop()`|
|slice|returns a sub-array|`a.slice(1,-1)`|
|sort|run a function to sort an array in place|`a.sort((a,b) => b-a)`|
|values|creates an iterator for use with a `for of` loop|`for (i of a.values()) {...}`|
|find|find the first item satisfied by a test function|`a.find(i => i < 2)`|
|forEach|run a function on each array item|`a.forEach(console.log)`|
|reduce|run a function to reduce each array item to a single item|`a.reduce((a,c) => a + c)`|
|map|run a function to map an array to a new array|`a.map(i => i+i)`|
|filter|run a function to remove items|`a.filter(i => i%2)`|
|every|run a function to test if all items match|`a.every (i => i < 3)`|
|some|run a function to test if any items match|`a.some(i => 1 < 1)`|

```javascript
const a = [1, 2, 3];

console.log(a.map((i) => i + i));
// OUTPUT: [2,4,6]
console.log(a.reduce((v1, v2) => v1 + v2));
// OUTPUT: 6
console.log(a.sort((v1, v2) => v2 - v1));
// OUTPUT: [3,2,1]

a.push(4);
console.log(a.length);
// OUTPUT: 4
```
## JavaScript Object Notation (JSON)
Created by Douglas Crockford in 2001 while working at Yahoo. It's pronounced like the name Jason. Officially standardised in 2013 and 2017.
JSON gives a simple and effective way to share and store data. It's easily convertable to, and from, JS objects, which makes it very convenient when working with web technologies. JSON is one of the worlds most popular data formats.

### Format
JSON document has one of these data types
|type|example|
|---|---|
|string|`"crockford"`|
|number|`42`|
|boolean|`true`|
|array|`[null,42,"crockford"]`|
|object|`{"a":1,"b":"crockford"}`|
|null|`null`|

A JSON document has an object. These contain zero or more key value pairs. A key is always a string, and the value has to be one of the valid JSON data types. Key value pairs are set with commas, curly braces mean an object, square brackets and commas mean arrays, and strings are always made with double quotes.

example:
```JSON
{
  "class": {
    "title": "web programming",
    "description": "Amazing"
  },
  "enrollment": ["Marco", "Jana", "ŸÅŸéÿßÿ∑ŸêŸÖŸéÿ©"],
  "start": "2025-02-01",
  "end": null
}
```
Always encoded with UTF-8, allowing for the representation of global data.

### Converting to JavaScript
Convert JSON to and from JS using the `JSON.parse` and `JSON.stringify` functions.

```javascript
const obj = { a: 2, b: 'crockford', c: undefined };
const json = JSON.stringify(obj);
const objFromJson = JSON.parse(json);

console.log(obj, json, objFromJson);

// OUTPUT:
// {a: 2, b: 'crockford', c: undefined}
// {"a":2, "b":"crockford"}
// {a: 2, b: 'crockford'}
```

In this example, JSON cannot represent JS undefined object so it gets dropped when converting from JS to JSON.

## JavaScript Object and Classes
An object represents a collection of name value pairs referred to as properties. The name has to be type string or symbol, but the value can be any type. There are common object-oriented functionality like constructors, pointers, static properties and functions, and inheritance.

Objects are created with the new operator. After it has been created, you can add properties by referencing the property name in an assignment. Any type of variable can be used for a property, including sub-object, array, or function. Properties are referenced by either a dot `obj.prop` or brackets `obj['prop']`.

```javascript
const obj = new Object({a: 3});

obj['b'] = 'fish';
obj.c = [1, 2, 3];
obj.hello = function () {
  console.log('hello');
};

console.log(obj);
// OUTPUT: {a: 3, b: 'fish', c: [1,2,3], hello: func}
```

Dynamically modifying objects is useful when manipulating data with an indeterminate structure.

note: standard javascript objects: promise, map, object, function, date...
or it can refer to the JS Object object (`new Object`)
or it can refer to any JS object you create (`{a:'a', b:2}`)

### Object literals
You can declare a variable of object type with `object-literal` syntax. This allows for the initial composition 

```javascript
const obj = {
  a: 3,
  b: 'fish',
};
```

### Object functions

|function|meaning|
|---|---|
|entries|returns an array of key value pairs|
|keys|returns an array of keys|
|values|returns an array of values|

```javascript
const obj = {
  a: 3,
  b: 'fish',
};

console.log(Object.entries(obj));
// OUTPUT: [['a', 3], ['b', 'fish']]
console.log(Object.keys(obj));
// OUTPUT: ['a', 'b']
console.log(Object.values(obj));
// OUTPUT: [3, 'fish']
```

### constructor
Any function that returns an obkect is a constructor and can be invoked with the new operator

```javascript
function Person(name) {
  return {
    name: name,
  };
}

const p = new Person('Eich');
console.log(p);
// OUTPUT: {name: 'Eich'}
```

Because objects can have any type of property value, you can create methods of the object as part of its encapsulation

```
function Person(name) {
  return {
    name: name,
    log: function () {
      console.log('My name is ' + this.name);
    },
  };
}

const p = new Person('Eich');
p.log();
// OUTPUT: My name is Eich
```

### this pointer
The meaning of `this` depends on the scope of where it is used. 
In object context, it refers to a pointer to the object

### classes
Using a class to define an object clarifies the intent to create a reusable componenet rather than a one off object. Class declarations are similar to declaring an object, except class declarations have an explicit constructor and assumed function declarations.

```javascript
class Person {
  constructor(name) {
    this.name = name;
  }

  log() {
    console.log('My name is ' + this.name);
  }
}

const p = new Person('Eich');
p.log();
// OUTPUT: My name is Eich
```

You can make properties and functions of classes private by prefixing them with a `#`

```javascript
class Person {
  #name;

  constructor(name) {
    this.#name = name;
  }
}

const p = new Person('Eich');
p.#name = 'Lie';
// OUTPUT: Uncaught SyntaxError: Private field '#name' must be declared in an enclosing class

```

### inheritance
Classes are extended by using the `extends` keyword to define inheritance. Anything that needs to be passed into the parent class are delivered with the `super` function. Any functions defined on the child that have the same name as the parents will override the parents implementation. A parents function can be explicitly accessed with the `super` function though.

```javascript
class Person {
  constructor(name) {
    this.name = name;
  }

  print() {
    return 'My name is ' + this.name;
  }
}

class Employee extends Person {
  constructor(name, position) {
    super(name);
    this.position = position;
  }

  print() {
    return super.print() + '. I am a ' + this.position;
  }
}

const e = new Employee('Eich', 'programmer');
console.log(e.print());
// OUTPUT: My name is Eich. I am a programmer
```

## Regular expressions
These are textual pattern matchers. You use them to find text in a string so you can replace it, or simply know it's there. They're created using the class constructor or a regular expression literal.

```javascript
const objRegex = new RegExp('ab*', 'i');
const literalRegex = /ab*/i;
```

Common functions include `match`, `replace`, `search`, and `split`. A quick way to test if there is a match you can use the `test` function.

```javascript
const petRegex = /(dog)|(cat)|(bird)/gim;
const text = 'Both cats and dogs are pets, but not rocks.';

text.match(petRegex);
// RETURNS: ['cat', 'dog']

text.replace(petRegex, 'animal');
// RETURNS: Both animals and animals are pets, but not rocks.

petRegex.test(text);
// RETURNS: true
```

## Rest and Spread

### Rest
Say you wanted to make a function to take an unknown amount of parameters. JS has the `rest` syntax to make it easier. It's like a parameter that holds the `rest` of the parameters. You can turn any last parameter into a rest parameter by adding three periods. Then all the parameters will immediately be added into an array.

```javascript
function hasNumber(test, ...numbers) {
  return numbers.some((i) => i === test);
}

hasNumber(2, 1, 2, 3);
// RETURNS: true
```

You can only do this with the last parameter. Otherwise JS doesn't know which ones to put in the array. Technically speaking, rest allows JS to provide variadic functions.

### Spread
This is the opposite of rest. It takes any iterable object and expands it into a functions parameters. For example:

```javascript
function person(firstName, lastName) {
  return { first: firstName, last: lastName };
}

const p = person(...['Ryan', 'Dahl']);
console.log(p);
// OUTPUT: {first: 'Ryan', last: 'Dahl'}
```

## Exceptions
JS handles exceptions with the `try catch` and `throw` syntax. Exceptions can be triggered when your code generates an exception using the `throw` keyword, or whenever it's generated by the JS runtime (like when an undefined variable is used). To catch an exception, you wrap a code in the `try` keyword, and follow it with a `catch` block. If there is an exception within the try block, all the code after the throw is ignored, the stack is unwound, and the catch block is called. You can also add a `finally` block that is alawys called whenever the `try` block is exited regardless if an exception was thrown.

Basic syntax:

```javascript
try {
  // normal execution code
} catch (err) {
  // exception handling code
} finally {
  // always called code
}
```

Example:

```javascript
function connectDatabase() {
  throw new Error('connection error');
}

try {
  connectDatabase();
  console.log('never executed');
} catch (err) {
  console.log(err);
} finally {
  console.log('always executed');
}

// OUTPUT: Error: connection error
//         always executed
```

Throwing exceptions should only happen when something exceptional occurs. For example, `file not found` exception when the file is required for your code to run, like a required congifuration file. It makes it easier to debug, and your logs more meaningful. 

### Fallbacks
This pattern is commonly implented while handling exceptions. To use it, you put the normal feature path in a try block and then provide a fallback implementation in the catch block. For example, normally you would get the highscores for a game with a network request. But if the network is not available then a locally cached version of the last available scores is used. By providing a fallback, you can always return something even if what you want can't be returned.

```javascript
function getScores() {
  try {
    const scores = scoringService.getScores();
    // store the scores so that we can use them later if the network is not available
    window.localStorage.setItem('scores', scores);
    return scores;
  } catch {
    return window.localStorage.getItem('scores');
  }
}
```

## Destructuring
This is the process of pulling individual items out of an existing one, or removing structure. You can do this with arrays or objects. It's helpful when you only care about a few items in the original structure.

Example of destructuring an array:

```javascript
const a = [1, 2, 4, 5];

// destructure the first two items from a, into the new variables b and c
const [b, c] = a;

console.log(b, c);
// OUTPUT: 1, 2
```

It looks like you're declaring an array on the left, but it is only specifyinh that you want to destructure those values out of the array. You can also combine multiple items from the original object using rest.

```javascript
const [b, c, ...others] = a;

console.log(b, c, others);
// OUTPUT: 1, 2, [4,5]
```

This works in a similar manner for objects, except with arrays, the assignment of the associated value was assumed by the positions in the two arrays. When destructuring objects, you explicitly specify the properties you want to pull from the source object.

```javascript
const o = { a: 1, b: 'animals', c: ['fish', 'cats'] };

const { a, c } = o;

console.log(a, c);
// OUTPUT 1, ['fish', 'cats']
```

You can also map the names to the new variables instead of just using the original property names.

```javascript
const o = { a: 1, b: 'animals', c: ['fish', 'cats'] };

const { a: count, b: type } = o;

console.log(count, type);
// OUTPUT 1, animals
```

Default values may also be provided for missing ones.

```javascript
const { a, b = 22 } = {};
const [c = 44] = [];

console.log(a, b, c);
// OUTPUT: undefined, 22, 44
```

Note that all of these examples created new constant variables, but you can also use destructuring to reassign existing variables.

```javascript
let a = 22;

[a] = [1, 2, 3];

console.log(a);
// OUTPUT: 1
```

## Scope
Scope is defined as the variables that are visibile in the current context of execution. JS has four different types.

- global -> visible to all code
- module -> visible to all code running in a module
- function -> visible within a function
- block -> visibile within a block of code delimited by curly braces

### Var
Var was initially used to declare a variable. However, unlike const or let, var ignores block scope. Variables declared with `var` are always logically brought to the top of the function. In this example, the code shows the same variable name being used within different enclosing scopes. However, because var ingores blocks, the for loop is simply assigning a new variable to `x` rather than declaring a new one.

```javascript
var x = 10;
console.log('start', x);

for (var x = 0; x < 1; x++) {
  console.log('middle', x);
}

console.log('end', x);

// OUTPUT: start 10
//         middle 0
//         end 1
```

There are only a few cases where it makes sense to use var. Only really use const and let unless you REALLY understand.

### This
`this` keyword represents a variable that points to an object that contains the context within the scope of the currently executing line of code. `this` variable is automatically declared and you can reference it anywhere within a JS program. Because the value depends on the context, there are three different contexts:

- global -> when its referenced outside a function or object it refers to the `globalThis` obkect. This object represents the context for runtime environment. Ex: when running in a browser, `globalThis` refers to the browsers window object.
- function -> When it references a function, it refers to the object that owns the function. That is either an object you defined or the `globalThis` if the function is defined outside of an object. When running in JS strict mode, a global function's `this` variable is undefined instead of `globalThis`.
- objcet -> When referenced in an object it refers to the object.

```javascript
'use strict';

// global scope
console.log('global:', this);
console.log('globalThis:', globalThis);

// function scope for a global function
function globalFunc() {
  console.log('globalFunctionThis:', this);
}
globalFunc();

// object scope
class ScopeTest {
  constructor() {
    console.log('objectThis:', this);
  }

  // function scope for an object function
  objectFunc() {
    console.log('objectFunctionThis:', this);
  }
}

new ScopeTest().objectFunc();
```

Running this code in a browser returns:

```
global: Window
globalThis: Window
globalFunctionThis: undefined
objectThis: ScopeTest
objectFunctionThis: ScopeTest
```

(If we weren't using strict mode, `globalFunctionThis` would refer to window)

### Closure
A closure is defined as a function and its surround state. That means whatever variables are accessible when a function is created are available inside that function. This holds true even if you pass the function outside of the scope of its original creation.

Ex: This function has access to the objects `this` pointer:

```javascript
globalThis.x = 'global';

const obj = {
  x: 'object',
  f: function () {
    console.log(this.x);
  },
};

obj.f();
// OUTPUT: object
```

Arrow functions are different because they inherit the `this` function of their creation context. So change the previous example to return an arrow function, then the pointer at the time of creation will be `globalThis`

```javascript
globalThis.x = 'global';

const obj = {
  x: 'object',
  f: () => console.log(this.x),
};

obj.f();
// OUTPUT: global
```

If we make a function that returns an arrow function, then the `this` pointer will be the objects `this` pointer since that was the active context at the time the arrow function was created.

```javascript
globalThis.x = 'global';

const obj = {
  x: 'object',
  make: function () {
    return () => console.log(this.x);
  },
};

const f = obj.make();
f();
// OUTPUT: object
```

## Modules
Modules allow for the partitioning and sharing of code. JS used to have no support for these. Node.js, which is a side server JS execution application, introduced the concept in order to support the importing of packages of JS from third party providers. With ES6, JS has full module support and they are now standard representation as browser support for ES modules is now almost universal.

Node.js modules are called CommonJS modules and JS modules are called ES modules.

Modules create a file-based scope for the code they represent, so you must explicitly export the objects from one file then import them into another file. Ex: a module that exports a function that displays an alert.

```javascript
export function alertDisplay(msg) {
  alert(msg);
}
```

You can import the modules exported function into another module using the `import` keyword.

```javascript
import { alertDisplay } from './alert.js';

alertDisplay('called from main.js');
```

### ES modules in the browser
This can get complicated. Modules can only be called from other modules. You can't access JS contained in a module from the global scope that your non-module JS is executing in.

From your HTML, you can specify that you are using an ES module by including a `type` attribute with the value of `module` in the `script` element. You can then import other modules. Ex:

```html
<script type="module">
  import { alertDisplay } from './alert.js';
  alertDisplay('module loaded');
</script>
```

If you want to use a module in the global scope that our JS is executing in, you have to leak it into the global space. This is done by either attaching an event handler or explicitly adding a function to the global wundow object. This example uses the `alertDisplay` imported module function by attaching it to the global JS `window` object so that it can be called from the `onclick` button handler. We also expose the module function by attaching a `keypress` event.

```html
<html>
  <body>
    <script type="module">
      import { alertDisplay } from './alert.js';
      window.btnClick = alertDisplay;

      document.body.addEventListener('keypress', function (event) {
        alertDisplay('Key pressed');
      });
    </script>
    <button onclick="btnClick('button clicked')">Press me</button>
  </body>
</html>
```

The ES module funcction will be called every time the button is pushed or a key is pressed.

### Modules with web framework
You usually don't have to worry about differentiating between global scope and ES module scope. The bundler will inject all the necessary syntax to connect your HTML to your modules. This used to be done by removing the modules and putting all the JS in a namespaced global partition. Now, ES modules are supported on most browsers so the bundler will expose the ES Module directly.

## Document object model (DOM)
The DOM is an object representation of the HTML elements that the browser uses to render the display. The browser also exposes the DOM to external code so that you can write programs that dynamically manipulate the HTML.

The browser provides access to the DOM through a global variable named `document` that points to the root element of the DOM. If you open the browser's debugger console window and type the variable name `document` you will see the DOM for the document the browser is currently reading.

```html
> document

<html lang="en">
  <body>
    <p>text1 <span>text2</span></p>
    <p>text3</p>
  </body>
</html>
```

```css
p {
  color: red;
}
```

For everything in the HTML document, there is a node in the DOM, including attribute, elements, text, comments, and whitespace. These form a big tree, with the document node at the top.

### Accessing the DOM
Every element in an HTML document implements the DOM element interface, which is derived from the DOM node interface. The element interface provides a way for iterating child elements, accessing the parent element, and manipulating the elements attributes. For your JS code, you can start with the `document` variable and walk through every element in the tree.

```javascript
function displayElement(el) {
  console.log(el.tagName);
  for (const child of el.children) {
    displayElement(child);
  }
}

displayElement(document);

```

You can provide a CSS selector to the `querySelectorAll` function in order to select elements from the document. The `textContent` property contains all the elements text. You can even access a textual representation of an elements HTML content with the `innerHTML` property.

```javascript
const listElements = document.querySelectorAll('p');
for (const el of listElements) {
  console.log(el.textContent);
}
```

### Modifying the DOM
DOM supports the ability to insert, modify, or delete the elements of the DOM. To make a new element, you create the element in the DOM document first. You can then insert the element into the DOM tree by appending it to an existing element in the tree.

```javascript
function insertChild(parentSelector, text) {
  const newChild = document.createElement('div');
  newChild.textContent = text;

  const parentElement = document.querySelector(parentSelector);
  parentElement.appendChild(newChild);
}

insertChild('#courses', 'new course');
```

To delete all elements call the `removeChild` function on the parent element

```javascript
function deleteElement(elementSelector) {
  const el = document.querySelector(elementSelector);
  el.parentElement.removeChild(el);
}

deleteElement('#courses div');
```

### Injecting HTML
DOM lets you inject entire blocks of HTML into an element. The next code finds the first `div` element in the DOM and replaces all the HTML in it.

```javascript
const el = document.querySelector('div');
el.innerHTML = '<div class="injected"><b>Hello</b>!</div>';
```

But directly injecting HTML as a block of text is a common attack vector for hackers. It's not good if an untrusted party can inject JS anywhere in your application because that JS can represent itself as the user of the application. The attacker can then make requests for sensitive data, monitor activity, and steal credentials. The example below shows how its done as soon as the page is loaded.

```html
<img src="bogus.png" onerror="console.log('All your base are belong to us')" />
```

If you are injecting HTML, make sure it can't be manipulated by a user. Common paths include HTML input controls, URL parameters, and HTTP headers. Either sanitise any HTML with variables, or simply use DOM manipulation functions instead of using `innerHTML`.

## Event listeners
DOM elements support the ability to attach a function that gets called when an event occurs on the elements. Example of event listener that gets called when an element is clicked on.

```javascript
const submitDataEl = document.querySelector('#submitData');
submitDataEl.addEventListener('click', function (event) {
  console.log(event.type);
});
```

You can listeners to a lot of things, including the mouse, keyboard, scrolling, animation, video, audio, websocket, and clipboard events.
Commonly used ones:

|event category|description|
|---|---|
|clipboard|cut, copied, pasted|
|focus|an element gets focus|
|keyboard|keys are pressed|
|mouse|click events|
|text selection|when text is selected|

You can also add them directly in the HTML.

```html
<button onclick='alert("clicked")'>click me</button>
```

## local storage
the `localStorage` API provides the ability to persistantly store and retrieve data (like scores and usernames) on a users browser across user sessions and HTML page renderings. For example, frontend JS code could store a users name on one HTML page, and then retrieve it later when a different HTML page is loaded. The users name will also be available in local storage the next time the same browser is used to access the same website. 

It is also used as a cache for when data cannot be obtained from the server. For example, your frontend JS could store the last high scores obtained from the service, and then display those scores in the future if the service is not available.

### how to use
four main functions

|function|meaning|
|---|---|
|setItem(name, value)|sets a named items value into loval storage|
|getItem(name)|gets a named items value from local storage|
|removeItem(name)|removes a named item from local storage|
|clear()|clears all items in local storage|

A local storage value has to be type `string` `number` or `boolean`. If you want to store a JS object or array, you have to first convert it to a JSON string with JSON.stringify() on insertion, and parse it back to JS with JSON.parse() when retrieved.

### example
run this on your startup website in the browsers dev tools console window

```javascript
let user = 'Alice';

let myObject = {
  name: 'Bob',
  info: {
    favoriteClass: 'CS 260',
    likesCS: true,
  },
};

let myArray = [1, 'One', true];

localStorage.setItem('user', user);
localStorage.setItem('object', JSON.stringify(myObject));
localStorage.setItem('array', JSON.stringify(myArray));

console.log(localStorage.getItem('user'));
console.log(JSON.parse(localStorage.getItem('object')));
console.log(JSON.parse(localStorage.getItem('array')));
```

output
```
Alice
{name: 'Bob', info: {favoriteClass: 'CS 260', likesCS: true}
[1, 'One', true]
```

You can see the round trip jounrey of the local storage values in the console output. If you want to see what values are currently set for your application, then open the `Application` tab of the dev tools and select `Storage > Local Storage` and then your domain name. With dev tools you can add, view, update, and delete any local storage values.

## Promises
The rendering thread of HTML executes on a single thread. This means that you cannot take a long time processing JS on the main rendering thread. Long running, or blocking tasks, should be executed with the use of JS promise. Promise allows the main rendering thread to continue while some action is executed in the background. You can create a promise by caling the promise object constructor and passing it as executor function that runs the asynchronous operation. Executing asynchronously means that promise constructer may return before the promise executor function runs. The state of the promise execution is either one of three things.
1) pending -> currently running asynchronously
2) fulfulled -> completed successfully
3) rejected -> failed to complete

These can be demonstrated by using the standard JS `setTimeout` function to create a delay in the execution of the code. This function takes the number of milliseconds to wait and a function to call after that amount of time has passed. We call the delay function in a for loop in the promise executor and also a for loop outside the promise so that both blocks are running in parallel.

```javascript
const delay = (msg, wait) => {
  setTimeout(() => {
    console.log(msg, wait);
  }, 1000 * wait);
};

new Promise((resolve, reject) => {
  // Code executing in the promise
  for (let i = 0; i < 3; i++) {
    delay('In promise', i);
  }
});

// Code executing after the promise
for (let i = 0; i < 3; i++) {
  delay('After promise', i);
}

// OUTPUT:
//   In promise 0
//   After promise 0
//   In promise 1
//   After promise 1
//   In promise 2
//   After promise 2
```
### resolving and rejecting
The promise executor function takes two functions as parameters `resolve` and `reject`. calling resolve sets the promise to the fulfilled state, and called reject sets the promise to the rejected state.

```javascript
const coinToss = new Promise((resolve, reject) => {
  setTimeout(() => {
    if (Math.random() > 0.5) {
      resolve('success');
    } else {
      reject('error');
    }
  }, 10000);
});
```
If you log the coinToss promise object to the console immediately after calling the constructor, it will display that it is in the pending state.

```javascript
console.log(coinToss);
// OUTPUT: Promise {<pending>}
```

If you then wait ten seconds and then log the coinToss promise object again, the state will either show as fulfilled or rejected depending upon the way the coin landed.

```javascript
console.log(coinToss);
// OUTPUT: Promise {<fulfilled>}
```

### then catch finally
The promise object has three functions, `then`, `catch`, `finally`. The `then` function is called if the promise is fulfilled, the `catch` is called if the promise if rejected, and `finally` is always called after the processing is completed.

```javascript
const coinToss = new Promise((resolve, reject) => {
  setTimeout(() => {
    if (Math.random() > 0.1) {
      resolve(Math.random() > 0.5 ? 'heads' : 'tails');
    } else {
      reject('fell off table');
    }
  }, 10000);
});
```

Chain the then catch and finally functions to the coinToss object in order to handle each of the possible results.

```javascript
coinToss
  .then((result) => console.log(`Coin toss result: ${result}`))
  .catch((err) => console.log(`Error: ${err}`))
  .finally(() => console.log('Toss completed'));

// OUTPUT:
//    Coin toss result: tails
//    Toss completed
```

## Async/await
The `await` keyword wraps the execution of a promise and removed the need to chain functions. It will block until the promise state moves to fulfilled, or throws an exception if its rejected.

```javascript
const coinToss = () => {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      if (Math.random() > 0.1) {
        resolve(Math.random() > 0.5 ? 'heads' : 'tails');
      } else {
        reject('fell off table');
      }
    }, 1000);
  });
};
```
We can create equialent executions with either a promise then/catch chain, or an await with a try/catch block.

### then catch chain version
```javascript
coinToss()
  .then((result) => console.log(`Toss result ${result}`))
  .catch((err) => console.error(`Error: ${err}`))
  .finally(() => console.log(`Toss completed`));
```

### async try/catch version
```javascript
try {
  const result = await coinToss();
  console.log(`Toss result ${result}`);
} catch (err) {
  console.error(`Error: ${err}`);
} finally {
  console.log(`Toss completed`);
}
```

### async
You cannot await unless it is called at the top level of the JS, or is in a function that is defined with the async keyword. Applying async transforms the function so that it returns a promise that will resolve to the value that was previously returned by the function. It basically turns any function into an asynchronous function, so that it can in turn make asynchronous requests.

This function returns a simple string
```javascript
function cow() {
  return 'moo';
}
console.log(cow());
// OUTPUT: moo
```

If we designate it as asynchronous then the return value becomes a promise that is immediately resolved and has a value that is the return value of the function

```javascript
async function cow() {
  return 'moo';
}
console.log(cow());
// OUTPUT: Promise {<fulfilled>: 'moo'}
```

Changing the cow function to explicitly create a promise instead of automatically generated promise the await keyword generates

```javascript
async function cow() {
  return new Promise((resolve) => {
    resolve('moo');
  });
}
console.log(cow());
// OUTPUT: Promise {<pending>}
```

### await
Await wraps a call to the `async` function, blocks execution until the promise has resolved, and then returns the result of the promise. 

This can be demonstrated with the cow example again. If we log the output of the cow function then we see that the return value is a promise. However, if we prefix the call to the function with the await keyword, the execution will stop until the promise has been resolved, then the result of the promise is returned instead of the actual promise object

```javascript
console.log(cow());
// OUTPUT: Promise {<pending>}

console.log(await cow());
// OUTPUT: moo
```

Combing async (to define functions that return promises) with await (to wait on the promise), you can create code that is asynchronous, but still maintains the flow of the code without explicitly using callbacks.

### putting it all together
See the benefit clearly by considering a case where multiple promises are requried. For example, when calling the fetch web API on the endpoint that returns JSON, you would need to resolve two promises. One for the network call, and one for converting to JSON.

```javascript
const httpPromise = fetch('https://simon.cs260.click/api/user/me');
const jsonPromise = httpPromise.then((r) => r.json());
jsonPromise.then((j) => console.log(j));
console.log('done');

// OUTPUT: done
// OUTPUT: {email: 'bud@mail.com', authenticated: true}
```

You can clarify the code intent by hiding the promise syntax, and also make the execution block until the promise is resolved

```javascript
const httpResponse = await fetch('https://simon.cs260.click/api/user/me');
const jsonResponse = await httpResponse.json();
console.log(jsonResponse);
console.log('done');

// OUTPUT: {email: 'bud@mail.com', authenticated: true}
// OUTPUT: done
```

# The Internet
When one device wants to talk to another, it needs an IP address. Symbolic names are easier to remember, so people make domain names. Domain names are converted to IP addresses by a lookup in the Domain Name System (DNS). You can look up the IP address for any domain using `dig`.

```
-> dig byu.edu

byu.edu.		5755	IN	A	128.187.16.184
```

With the IP address, you connect to the device it represents first by asking for a connection route to the device. A connection route is made through many different hops across the network until it reaches the destination and establishes a connection. Then the transport and application layers start exchanging data.

You can find out all the hops with `traceroute` console utility. Here's an example with byu.

```
-> traceroute byu.edu

traceroute to byu.edu (128.187.16.184), 64 hops max, 52 byte packets
 1  192.168.1.1 (192.168.1.1)  10.942 ms  4.055 ms  4.694 ms
 2  * * *
 3  * * *
 4  192-119-18-212.mci.googlefiber.net (192.119.18.212)  5.369 ms  5.576 ms  6.456 ms
 5  216.21.171.197 (216.21.171.197)  6.283 ms  6.767 ms  5.532 ms
 6  * * *
 7  * * *
 8  * * *
 9  byu.com (128.187.16.184)  7.544 ms !X *  40.231 ms !X
```

It might be a bit different if you run it again, as the connections are dynamically calculated and different. The fact that it can find a new route makes it resilient for when a device fails or disappears from the network.

You handle the actual sending of data with the TCP/IP mmodel. This covers everything from physical wires to the data that a web app sends. The top layer is the application layer, which handles user functionality (web (HTTP), mail (SMPT), files (FTP), remote shell (SSH), chat (IRC). Next is the transport layer -> breaks the application layers info into small chunks and sends the data. The actual connection is made on the internet layer, which finds the device you want to talk to and keeps the connection alive. Lastly is the link layer that handles the physical connections and hardware.

|layer|example|function|
|---|---|---|
|application|HTTPS|functionality like web browsing|
|transport|TCP|moving connection information packets|
|internet|IP|establishing connections|
|link|fiber, hardware|physical connections|

# Web servers
A web server is a computing device that hosts a web service that knows how to accept incoming internet connections and speak the HTTP application protocol.

## monolithic web servers
In the early days, you had to buy massive, complex, expensive software that spoke hTTP and installed the hardware server. Both the server and the software was considered the web server, because web service software was the only thing running.

Originally, you could only send static HTML files. But that advanced to dynamic functionality, including being able to generate all the HTML on demand in response to a users interaction.

## combining web and application services
Most mosdern programming languages include libraries that provide the ability to make connections and serve HTTP. Here is a simple Go program that is a fully functioning web service.

```go
package main

import (
	"net/http"
)

func main() {
	// Serve up files found in the public_html directory
	fs := http.FileServer(http.Dir("./public_html"))
	http.Handle("/", fs)

	// Listen for HTTP requests
	http.ListenAndServe(":3000", nil)
}
```

Easily creating web services makes it easy to drop the monolithic web server and just build services right into your application. Take the Go example, and add a function that responds with the current time when requesting `/api/time`

```
package main

import (
	"fmt"
	"io"
	"net/http"
	"time"
)

func getTime(w http.ResponseWriter, r *http.Request) {
	io.WriteString(w, time.Now().String())
}

func main() {
	// Serve up files found in the public_html directory
	fs := http.FileServer(http.Dir("./public_html"))
	http.Handle("/", fs)

	// Dynamically provide data
	http.HandleFunc("/api/time", getTime)

	// Listen for HTTP requests
	fmt.Println(http.ListenAndServe(":3000", nil))
}
```

Run that web service code, and use the console app `curl` to make an HTTP request and see time response

```
-> curl localhost:3000/api/time

2022-12-03 09:50:37.391983 -0700
```

## web service gateways
It is common to find multiple web services running on the same device. You want to expose the multiple services in a way that a connection can be made to each of them. Every network allows for separate network connections by referring to unique port numbers. Each service on the device starts on a different port. In the Go website above, the service was using port 80. You could just have a user access each service by referring to the port it was launched on. This makes it hard for the user to remember what port matches to what service. We fix this with a gateway, or a reverse proxy, that is a simple web service that listens on the common HTTPS port 443. The gateway looks at the request and maps it to the other services running on different ports. Our web service uses Caddy.

## microservices
Web services that provice a single functional purpose are microservices. You separate functionality in small logical chuncks, so you can develop and manage them independtly from other functionality in a large system. They also handle fluctuation in user demand by running more and more stateless copies of the microservice from multiple virtual servers hosted in a dynamic cloud environment. Example: a microservice for generating your genealogical family tree might be able to handle 1,000 users concurrently. To support 1 million users, you just deploy 1000 instances of the server running on scalable virtual hardware.

## serverless
Microservers evolved into `serverless` functionality where the server is conceptually removed from the architecture and you just write a function that speaks HTTP. The function is loaded through a gateway that maps a web request to the function. The gateway automatically scales the hardware needed to host the serverless function based on demand. This reduces what the web application developer needs to think about to a single independent function.

# Domain Names
A domain name is a text string that follows a specific naming convention and is listed in a special database called the domain name registry. Names are broken into a root domain, with one or more subdomain prefixes. The root is split into a secondary level domain and a top level domain. The top level domain (TLD) is things like `com` and `edu` and `click`. A root domain would be something like `byu.edu`, `google.com`, or `cs260.click`. The possible TLDs are controlled by ICANN.

The owner of the root domain can create any number of subdomains off the root domain Each subdomain may resolve to a different IP address. The owner of cs260.click can have subdomains for travel (`travel.cs260.click`), finance (`finance.cs260.click`), or a blog (`blog.cs260.click`). You can get info about a domain name from the domain name registry using the `whois` console utility.

```whois byu.edu

Domain Name: BYU.EDU

Registrant:
	Brigham Young University
	3009 ITB
	2027 ITB
	Provo, UT 84602
	USA

Administrative Contact:
	Mark Longhurst
	Brigham Young University
	Office of Information Technology
	1208 ITB
	Provo, UT 84602
	USA
	+1.8014220488
	markl@byu.edu

Technical Contact:
	Brent Goodman
	Brigham Young University
	Office of Information Technology
	1203J ITB
	Provo, UT 84602
	USA
	+1.8014227782
	dnsmaster@byu.edu

Domain record activated:    19-Jan-1987
Domain record last updated: 11-Jul-2022
Domain expires:             31-Jul-2025
```

This provudes info like technical contact to talk to if there is a problem with the domain, and an administrative contact to ttalk to if you want to buy the domain.

## DNS
After a domain name is in the registry, if can be listed with a domain name system (DNS) and is associated with a IP address. All DNS servers in the world references a few special DNS servers that are considered the `authoritative name servers` for associating a domain name with an IP address.

The DNS database records the facilitate the mapping of domain names to IP addresses come in several flavours. The main ones are `address (A)` and the `canonical name (CNAME) records. `A` records are straight mapping from a domain to an IP. `CNAME` maps one domain name to another name. This is a domain name alias. You can use CNAME to map something like byu.com and byu.edu so that either can be used.

When you enter a domain name in the browser, it first checks to see if it has the name already in its cache of names and if not, it contacts a DNS server for the IP address. The DNS also keeps a cache of names. If the name is not in the cache, it will request it from the `authoritative name server`. If they don't know, you get an unkown domain name error. If it does resolve, the nthe browser makes the HTTP connection to the IP address.

There are a lot of levels of name caching, which helps for performance reasons. However, it can be frustrating when you are trying to update the infor associated with your domain name. This is where `time to live (TIL)` setting for a domain record comes into play. You can set it for something short (5 mins) or long (several days). The different caching layers should then honour the TTL and clear their cache after the requested period has passed.

## Leasing a domain name
You can pay to lease an unused domain name for a specific period of time. Before it expires, you have the right to extend the lease for an addition amount of time. The cost varies from $3 to $200 a year. Buying, or sub-leasing, an existing domain from a private party can be very expensive, so its better buying something obsucre like `idigfor.gold` (available for only 101 dollars). This is a reason why companies have strange names.
